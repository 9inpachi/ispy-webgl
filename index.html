<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./css/bootstrap.min.css">
  <link rel="stylesheet" href="./css/dataTables.booststrap.css">
  <link rel="stylesheet" href="./css/ispy.css">

  <script src="./js/jquery-1.11.1.min.js"></script>
  <script src="./js/bootstrap.min.js"></script>
  <script src="./js/stats.min.js"></script>
  <script src="./js/three.js"></script>
  <script src="./js/CombinedCamera.js"></script>
  <script src="./js/TrackballControls.js"></script>

  <script src="./js/Projector.js"></script>
  <script src="./js/CanvasRenderer.js"></script>
  <script src="./js/SVGRenderer.js"></script>

  <script src="./js/jszip.min.js"></script>
  <script src="./js/jquery.dataTables.min.js"></script>
  <script src="./js/dataTables.bootstrap.js"></script>

  <script src="./js/setup.js"></script>
  <script src="./js/detector.js"></script>
  <script src="./js/load.js"></script>
  <script src="./js/draw.js"></script>
  <script src="./js/display.js"></script>

  <title>iSpy WebGL</title>
</head>
<body class="black">
  <div class="container">
    <div class="row">
      <div class="col-lg-12 bordered black" id="titlebar">
        <div class=row">
          <div class="col-lg-6" id="application-name">iSpy WebGL</div>
          <div class="col-lg-6" id="event-loaded"></div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-12 bordered black" id="toolbar">
        <table>
          <tr>
            <td>
              <a class="toolbar-button btn" data-toggle="modal" data-target="#open-files">
                <img src="./graphics/open.png" title="Open File"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button disabled btn" id="prev-event-button" onclick="ispy.prevEvent();">
                <img src="./graphics/prev-event.png" title="Previous Event"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button disabled btn" id="next-event-button" onclick="ispy.nextEvent();">
                <img src="./graphics/next-event.png" title="Next Event"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" onclick="ispy.setCameraHome();">
                <img src="./graphics/home.png" title="Return to Start View"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" onclick="ispy.zoom(0.5);">
                <img src="./graphics/zoom_in_24.png" title="Zoom In"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" onclick="ispy.zoom(-0.5);">
                <img src="./graphics/zoom_out_24.png" title="Zoom Out"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" onclick="ispy.setXY();">
                <img src="./graphics/z-plane.png" title="X-Y Plane"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" onclick="ispy.setZX();">
                <img src="./graphics/y-plane.png" title="Z-X Plane"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" onclick="ispy.setYZ();">
                <img src="./graphics/x-plane.png" title="Y-Z Plane"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" id="perspective-view" onclick="ispy.setPerspective();">
                <img src="./graphics/perspective-projection.png" title="Perspective View"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" id="orthographic-view" onclick="ispy.setOrthographic();">
                <img src="./graphics/orthographic-projection.png" title="Orthographic View"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" data-toggle="modal" data-target="#settings">
                <img src="./graphics/settings.png" title="Settings"/>
              </a>
            </td>
            <td>
              <a class="toolbar-button btn" data-toggle="modal" data-target="#about">
                <img src="./graphics/help2.png" title="About"/>
              </a>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-3 bordered black" id="treeview">
        <div class="table-responsive">
        <table class="table table-hover">
        </table>
        </div>
      </div>
      <!-- The canvas goes into this div -->
      <div class="col-lg-9 bordered black" id="display"></div>
    </div>
    <div class="row">
      <div class="col-lg-12 bordered black" id="tableview">
      <table id="collection-table" class="table">
        <caption>Click on a name under "Provenance", "Tracking", "ECAL", "HCAL", "Muon", and "Physics Objects" to view contents in table</caption>
      </table>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    $(function() {
      ispy.init();
      ispy.addGroups();
      ispy.addDetector();
      ispy.animate();

      // need to debug why this doesn't work
      // but standard table with bootstrap is not bad already
      //$('#collection-table').DataTable();
    });
  </script>
</body>

<div id="open-files" role="dialog" class="modal">
  <div class="modal-dialog modal-sm">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">Open File</h4>
      </div>
      <div class="modal-body">
        <table>
          <p><button type="button" class="btn btn-default" onclick="ispy.openDialog('#files'); ispy.loadWebFiles(); $('#open-files').modal('hide');">Open file(s) from the Web</button></p>
          <p>
            Open local file(s): <input type="file" id="local-files" onchange="ispy.loadLocalFiles();" onclick="$('#open-files').modal('hide');" multiple/>
          </p>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="files" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">Open Event</h4>
      </div>
      <div class="modal-body">
        <table class="table black" width="100%" id="browser-table">
          <tr>
            <th class="browser-header bordered black" width="50%">Files</th>
            <th class="browser-header bordered black">Events</th>
          </tr>
          <tr>
            <td class="bordered">
              <table class="table table-hover black" id="browser-files"></table>
            </td>
            <td class="bordered">
              <table class="table table-hover black" id="browser-events"></table>
            </td>
          </tr>
        </table>
      </div>
      <div class="modal-footer">

        <div class="bordered" id="selected-event"> </div>

        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-default" onclick="$('#files').modal('hide'); ispy.loadEvent();">Load</button>
      </div>
    </div>
  </div>
</div>

<div id="settings" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">Settings</h4>
      </div>
      <div class="modal-body">
        <p>
          Invert colors: <input type='checkbox' checked='false' onchange='ispy.invertColors();'>
        </p>
        <p>
          Show axes: <input type='checkbox' checked='false' onchange='ispy.showAxes();'>
        </p>
        <p>
          Show display statistics: <input type='checkbox' checked='false' onchange='ispy.showStats();'>
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="about" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">About</h4>
      </div>
      <div class="modal-body">
        <p>
          <h4>iSpy-WebGL <span id="version"></span></h4>
        </p>
        <p>
          A browser-based event display for the <a href="http://cern.ch/cms">CMS experiment</a> at the LHC using WebGL.
        </p>
        <p>
          <a href="mailto:ispy-developers@cern.ch">Questions/comments/problems</a>
        </p>
        <p>
          Get the code on <a href="https://github.com/cms-outreach/ispy-webgl">GitHub</a>
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Template me! ["Detector", "Provenance", "Tracking", "ECAL", "HCAL", "Muon", "PhysicsObjects"] -->

<div id="info-Detector" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">Detector</h4>
      </div>
      <div class="modal-body">
        <dl>
          <dt>Tracker:</dt>
          <dd>More on tracker</dd>
          <dt>ECAL Barrel:</dt>
          <dd>Central electromagnetic calorimeter; measures energy of electrons and photons</dd>
          <dt>ECAL Endcap:</dt>
          <dd>Electromagnetic calorimeters at either end of CMS for measurements close to the beam axis</dd>
          <dt>ECAL Preshower:</dt>
          <dd>More on preshower</dd>
          <dt>HCAL Barrel:</dt>
          <dd>Central hadronic calorimeter; measures energy of hadrons</dd>
          <dt>HCAL Endcap:</dt>
          <dd>Hadronic calorimeters at either end of CMS for measurements close to the beam axis</dd>
          <dt>HCAL Outer:</dt>
          <dd>Final HCAL layer just outside the solenoid magnet</dd>
          <dt>HCAL Forward:</dt>
          <dd>Hadronic calorimeters farther down and very close to the beam axis</dd>
          <dt>Drift Tubes (DT):</dt>
          <dd>Main large central muon chambers outside the solenoid and HCAL Outer using ionization of gas to record muon hits</dd>
          <dt>Cathode Strip Chambers (CSC):</dt>
          <dd>Forward muon detectors</dd>
          <dt>Resistive Place Chambers (RPC):</dt>
          <dd>Solid state muon detectors</dd>
        </dl>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="info-Provenance" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">Provenance</h4>
      </div>
      <div class="modal-body">
        <dl>
          <dt>Event:</dt>
          <dd>Each event is dstinguished by a run number, event number, luminosity section, and time stamp</dd>
        </dl>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="info-Tracking" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">Tracking</h4>
      </div>
      <div class="modal-body">
          <dl>
            <dt>Tracks (reco.):</dt>
            <dd>All reconstructed particle tracks in the tracker</dd>
          <!--
            <dt>Clusters (Si Pixels):</dt>
            <dd>Recorded events in the innermost part of the tracker</dd>
            <dt>Clusters (Si Strips):</dt>
            <dd>Recorded events in the tracker</dd>
            <dt>Rec. Hits (Tracking):</dt>
            <dd>All particle hits in the tracker</dd>
          -->
          </dl>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="info-ECAL" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">ECAL</h4>
      </div>
      <div class="modal-body">
        <dl>
          <dt>Barrel Rec. Hits:</dt>
          <dd>Energy in a single ECAL crystal</dd>
          <dt>Endcap Rec. Hits:</dt>
          <dd>Hits in ECAL Endcap</dd>
          <dt>Preshower Rec. Hits:</dt>
          <dd>Hits in ECAL Preshower</dd>
        </dl>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="info-HCAL" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">HCAL</h4>
      </div>
      <div class="modal-body">
        <dl>
          <dt>Barrel Rec. Hits:</dt>
          <dd>Energy in a single HCAL tile</dd>
          <dt>Endcap Rec. Hits:</dt>
          <dd>Hits in HCAL Endcap</dd>
          <dt>Forward Rec. Hits:</dt>
          <dd>Hits in HCAL Forward</dd>
          <dt>Outer Rec. Hits:</dt>
          <dd>Hits in HCAL Outer</dd>
        </dl>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="info-Muon" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">Muon</h4>
      </div>
      <div class="modal-body">
        <dl>
          <dt>Matching muon chambers:</dt>
          <dd>The muon chambers (drift tubes and/or cathode strip chambers) that correspond to the reconstructed muon</dd>
        <!--
          <dt>DT Rec. Hits:</dt>
          <dd>Muon hits in Drift Tubes (barrel)</dd>
          <dt>DT Rec. Segments:</dt>
          <dd>Muon track segments in Drift Tubes (barrel)</dd>
          <dt>CSC Segments:</dt>
          <dd>Muon track segments in Cathode Strip Chambers (forward)</dd>
          <dt>RPC Rec. Hits:</dt>
          <dd>Muon hits in Resistive Plate Chambers (barrel)</dd>
          <dt>CSC Rec. Hits:</dt>
          <dd>Muon hits in Cathode Strip Chambers (forward)</dd>
        -->
        </dl>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="info-PhysicsObjects" role="dialog" class="modal">
  <div class="modal-dialog">
    <div class="modal-content bordered black">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title black">Physics Objects</h4>
      </div>
      <div class="modal-body">
        <dl>
          <dt>Electron Tracks (GSF):</dt>
          <dd>Reconstructed candidate electron tracks in the tracker</dd>
          <dt>Photons (Reco):</dt>
          <dd>Inferred photon trajectories</dd>
          <dt>Tracker Muons (Reco):</dt>
          <dd>Reconstructed muon tracks in tracker</dd>
          <dt>Stand-alone Muons (Reco):</dt>
          <dd>Reconstructed muon track segments in muon chambers</dd>
          <dt>Global Muons (Reco):</dt>
          <dd>Reconstructed complete muon tracks, combining tracker and stand-alone muons</dd>
        <!--
          <dt>Calorimeter energy towers:</dt>
          <dd>Histogram "towers" to indicate energy deposits in calorimeters summed over the trajectories</dd>
        -->
          <dt>Jets:</dt>
          <dd>Collimated groups of particles</dd>
          <dt>MET:</dt>
          <dd>Missing transverse energy</dd>
        </dl>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
